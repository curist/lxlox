let lib = require("src/lib.lx")
let compiler = require("src/compiler.lx")
let objbuilder = require("src/objbuilder.lx")

let pp = lib.pp

fn main() {
  if len(Lx.args) != 2 {
    pp(["Usage: lxlox <path>"])
    Lx.exit(64)
  }

  let source = Lx.readTextFile(Lx.args[1])
  let result = compiler.compile(source)
  if !result.success {
    print("compile failed.")
    Lx.exit(65)
  }
  objbuilder(result.chunks).dump()
}

main()
